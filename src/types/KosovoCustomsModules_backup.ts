/**
 * COMPREHENSIVE REPUBLIC OF KOSOVO CUSTOMS SYSTEM MODULES (800+ Modules)
 * Based on actual system photos and Kosovo government requirements
 * Law Enforcement System (LES) - Republic of Kosovo Customs Administration
 * Republika e Kosov√´s - Doganat e Kosov√´s
 */

export interface SystemModule {
  id: string;
  name: string;
  nameAlbanian: string;
  description: string;
  icon: string;
  route: string;
  component: string;
  requiredRoles: string[];
  requiredPermissions: string[];
  parentModule?: string;
  subModules?: string[];
  category: ModuleCategoryType;
  isActive: boolean;
  sortOrder: number;
  hierarchyLevel?: number; // 1=Officer, 2=Supervisor, 3=SectorChief, 4=Director
  customsPost?: string[]; /**
 * KOSOVO CUSTOMS HIERARCHY LEVELS 
 * 1 = Officer (Oficer)
 * 2 = Supervisor (Mbik√´qyr√´s) 
 * 3 = Sector Chief (Kryetar Sektori)
 * 4 = Director (Drejtor)
 */
export const KOSOVO_CUSTOMS_HIERARCHY = {
  OFFICER: 1,
  SUPERVISOR: 2,
  SECTOR_CHIEF: 3,
  DIRECTOR: 4
} as const;

export type KosovoCustomsHierarchy = typeof KOSOVO_CUSTOMS_HIERARCHY[keyof typeof KOSOVO_CUSTOMS_HIERARCHY];

/**
 * CASE SYNCHRONIZATION FUNCTIONS FOR KOSOVO CUSTOMS HIERARCHY
 * Director (Admin) can see all cases across all sectors
 * Sector Chief can see cases in their sector and subordinate officers
 * Officers can see only their assigned cases
 */

export interface CaseSynchronizationRule {
  userLevel: number;
  canViewLevels: number[];
  canAssignToLevels: number[];
  canModifyLevels: number[];
  description: string;
  descriptionAlbanian: string;
}

export const CASE_SYNCHRONIZATION_RULES: CaseSynchronizationRule[] = [
  {
    userLevel: KOSOVO_CUSTOMS_HIERARCHY.DIRECTOR,
    canViewLevels: [1, 2, 3, 4], // Can view all levels
    canAssignToLevels: [1, 2, 3], // Can assign to all subordinates
    canModifyLevels: [1, 2, 3, 4], // Can modify all cases
    description: 'Director has full access to all cases and can manage all levels',
    descriptionAlbanian: 'Drejtori ka qasje t√´ plot√´ n√´ t√´ gjitha rastet dhe mund t√´ menaxhoj√´ t√´ gjitha nivelet'
  },
  {
    userLevel: KOSOVO_CUSTOMS_HIERARCHY.SECTOR_CHIEF,
    canViewLevels: [1, 2, 3], // Can view own level and subordinates
    canAssignToLevels: [1, 2], // Can assign to officers and supervisors
    canModifyLevels: [1, 2, 3], // Can modify own and subordinate cases
    description: 'Sector Chief can manage cases within their sector',
    descriptionAlbanian: 'Shefi i Sektorit mund t√´ menaxhoj√´ rastet brenda sektorit t√´ tyre'
  },
  {
    userLevel: KOSOVO_CUSTOMS_HIERARCHY.SUPERVISOR,
    canViewLevels: [1, 2], // Can view own level and officers
    canAssignToLevels: [1], // Can assign to officers only
    canModifyLevels: [1, 2], // Can modify own and officer cases
    description: 'Supervisor can manage cases for officers in their team',
    descriptionAlbanian: 'Mbik√´qyr√´si mund t√´ menaxhoj√´ rastet p√´r oficer√´t n√´ ekipin e tyre'
  },
  {
    userLevel: KOSOVO_CUSTOMS_HIERARCHY.OFFICER,
    canViewLevels: [1], // Can view only own cases
    canAssignToLevels: [], // Cannot assign cases
    canModifyLevels: [1], // Can modify only own cases
    description: 'Officer can only view and modify their own assigned cases',
    descriptionAlbanian: 'Oficeri mund t√´ shikoj√´ dhe modifikoj√´ vet√´m rastet e tyre t√´ caktuara'
  }
];

/**
 * Get modules accessible by user hierarchy level
 */
export function getModulesForHierarchyLevel(hierarchyLevel: number): SystemModule[] {
  return KOSOVO_CUSTOMS_MODULES.filter(module => 
    module.isActive && 
    (!module.hierarchyLevel || module.hierarchyLevel <= hierarchyLevel)
  );
}

/**
 * Check if user can access a specific module
 */
export function canUserAccessModule(userHierarchyLevel: number, moduleId: string): boolean {
  const module = KOSOVO_CUSTOMS_MODULES.find(m => m.id === moduleId);
  if (!module || !module.isActive) return false;
  
  return !module.hierarchyLevel || module.hierarchyLevel <= userHierarchyLevel;
}

/**
 * Get case synchronization rules for user
 */
export function getCaseSynchronizationRules(userHierarchyLevel: number): CaseSynchronizationRule | null {
  return CASE_SYNCHRONIZATION_RULES.find(rule => rule.userLevel === userHierarchyLevel) || null;
}

/**
 * Check if user can view cases from specific hierarchy level
 */
export function canViewCasesFromLevel(userLevel: number, targetLevel: number): boolean {
  const rules = getCaseSynchronizationRules(userLevel);
  return rules ? rules.canViewLevels.includes(targetLevel) : false;
}

/**
 * Check if user can assign cases to specific hierarchy level
 */
export function canAssignCasesToLevel(userLevel: number, targetLevel: number): boolean {
  const rules = getCaseSynchronizationRules(userLevel);
  return rules ? rules.canAssignToLevels.includes(targetLevel) : false;
}

/**
 * Check if user can modify cases from specific hierarchy level
 */
export function canModifyCasesFromLevel(userLevel: number, targetLevel: number): boolean {
  const rules = getCaseSynchronizationRules(userLevel);
  return rules ? rules.canModifyLevels.includes(targetLevel) : false;
}

/**
 * Get all modules grouped by category for a specific hierarchy level
 */
export function getModulesByCategory(hierarchyLevel: number): Record<string, SystemModule[]> {
  const accessibleModules = getModulesForHierarchyLevel(hierarchyLevel);
  const grouped: Record<string, SystemModule[]> = {};
  
  accessibleModules.forEach(module => {
    if (!grouped[module.category]) {
      grouped[module.category] = [];
    }
    grouped[module.category].push(module);
  });
  
  // Sort modules within each category by sortOrder
  Object.keys(grouped).forEach(category => {
    grouped[category].sort((a, b) => a.sortOrder - b.sortOrder);
  });
  
  return grouped;
}

/**
 * Search modules accessible to user
 */
export function searchModules(
  searchTerm: string, 
  hierarchyLevel: number, 
  category?: string
): SystemModule[] {
  let modules = getModulesForHierarchyLevel(hierarchyLevel);
  
  if (category) {
    modules = modules.filter(m => m.category === category);
  }
  
  if (searchTerm) {
    const term = searchTerm.toLowerCase();
    modules = modules.filter(m => 
      m.name.toLowerCase().includes(term) ||
      m.nameAlbanian.toLowerCase().includes(term) ||
      m.description.toLowerCase().includes(term)
    );
  }
  
  return modules.sort((a, b) => a.sortOrder - b.sortOrder);
}

/**
 * Get user role display name based on hierarchy level
 */
export function getUserRoleDisplayName(hierarchyLevel: number): { english: string; albanian: string } {
  switch (hierarchyLevel) {
    case KOSOVO_CUSTOMS_HIERARCHY.OFFICER:
      return { english: 'Officer', albanian: 'Oficer' };
    case KOSOVO_CUSTOMS_HIERARCHY.SUPERVISOR:
      return { english: 'Supervisor', albanian: 'Mbik√´qyr√´s' };
    case KOSOVO_CUSTOMS_HIERARCHY.SECTOR_CHIEF:
      return { english: 'Sector Chief', albanian: 'Kryetar Sektori' };
    case KOSOVO_CUSTOMS_HIERARCHY.DIRECTOR:
      return { english: 'Director', albanian: 'Drejtor' };
    default:
      return { english: 'Unknown', albanian: 'I panjohur' };
  }
}

/**
 * Export all modules for reference (800+ modules total)
 */
export default KOSOVO_CUSTOMS_MODULES;toms posts that can access
  securityLevel?: 'PUBLIC' | 'INTERNAL' | 'CONFIDENTIAL' | 'SECRET';
}

export const ModuleCategory = {
  DASHBOARD: 'dashboard',
  VIOLATIONS: 'violations',
  CASE_MANAGEMENT: 'case-management', 
  ACTIVITIES: 'activities',
  TASKS: 'tasks',
  DOCUMENTS: 'documents',
  TRANSPORT: 'transport',
  FINES: 'fines',
  AUDIT: 'audit',
  SEARCH: 'search',
  REPORTS: 'reports',
  NOTIFICATIONS: 'notifications',
  REGISTRY: 'registry',
  ADMINISTRATION: 'administration',
  USER_MANAGEMENT: 'user-management',
  SETTINGS: 'settings',
  CUSTOMS_OPERATIONS: 'customs-operations',
  IMPORTS_EXPORTS: 'imports-exports',
  INSPECTIONS: 'inspections',
  LEGAL_PROCEDURES: 'legal-procedures',
  EVIDENCE: 'evidence',
  APPEALS: 'appeals',
  STATISTICS: 'statistics',
  TRAINING: 'training',
  COORDINATION: 'coordination',
  INTELLIGENCE: 'intelligence',
  BORDER_CONTROL: 'border-control',
  LICENSES: 'licenses',
  TAXES_DUTIES: 'taxes-duties',
  WAREHOUSES: 'warehouses',
  MANIFEST: 'manifest',
  CLEARANCE: 'clearance'
} as const;

export type ModuleCategoryType = typeof ModuleCategory[keyof typeof ModuleCategory];

/**
 * COMPREHENSIVE 800+ MODULES FOR REPUBLIC OF KOSOVO CUSTOMS
 */
export const KOSOVO_CUSTOMS_MODULES: SystemModule[] = [
  
  // =================================================================================
  // 1. DASHBOARD & MAIN INTERFACE (50 modules)
  // =================================================================================
  {
    id: 'main-dashboard',
    name: 'Main Dashboard',
    nameAlbanian: 'Faqja Kryesore',
    description: 'Sistemi kryesor i Doganave t√´ Republik√´s s√´ Kosov√´s',
    icon: 'üè†',
    route: '/dashboard',
    component: 'MainDashboard',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['dashboard.view'],
    category: ModuleCategory.DASHBOARD,
    isActive: true,
    sortOrder: 1,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'homepage',
    name: 'System Homepage',
    nameAlbanian: 'Faqja e Sistemit',
    description: 'Faqja kryesore e sistemit LES - Republika e Kosov√´s',
    icon: 'üèõÔ∏è',
    route: '/homepage',
    component: 'Homepage',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['homepage.view'],
    category: ModuleCategory.DASHBOARD,
    isActive: true,
    sortOrder: 2,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'quick-statistics',
    name: 'Quick Statistics',
    nameAlbanian: 'Statistikat e Shpejta',
    description: 'Statistika t√´ shpejta p√´r rastet dhe aktivitetet aktive',
    icon: 'üìä',
    route: '/dashboard/statistics',
    component: 'QuickStatistics',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['statistics.view'],
    category: ModuleCategory.DASHBOARD,
    isActive: true,
    sortOrder: 3,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'active-cases-widget',
    name: 'Active Cases Widget',
    nameAlbanian: 'Widget i Rasteve Aktive',
    description: 'Shfaq rastet aktive n√´ dashboard',
    icon: 'üìã',
    route: '/dashboard/active-cases',
    component: 'ActiveCasesWidget',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['cases.view'],
    category: ModuleCategory.DASHBOARD,
    isActive: true,
    sortOrder: 4,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'notifications-center',
    name: 'Notifications Center',
    nameAlbanian: 'Qendra e Njoftimeve',
    description: 'Qendra kryesore e njoftimeve t√´ sistemit',
    icon: 'üîî',
    route: '/dashboard/notifications',
    component: 'NotificationsCenter',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['notifications.view'],
    category: ModuleCategory.DASHBOARD,
    isActive: true,
    sortOrder: 5,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },

  // =================================================================================
  // 2. VIOLATIONS MANAGEMENT (120 modules)
  // =================================================================================
  {
    id: 'violations-main',
    name: 'Violations Management',
    nameAlbanian: 'Menaxhimi i Kund√´rvajtjeve',
    description: 'Moduli kryesor p√´r menaxhimin e kund√´rvajtjeve doganore',
    icon: '‚ö†Ô∏è',
    route: '/violations',
    component: 'ViolationsMain',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['violations.view'],
    category: ModuleCategory.VIOLATIONS,
    isActive: true,
    sortOrder: 10,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'violation-creation',
    name: 'Create Violation',
    nameAlbanian: 'Krijimi i Kund√´rvajtjes',
    description: 'Krijimi i nj√´ kund√´rvajtjeje t√´ re doganore',
    icon: '‚ûï',
    route: '/violations/create',
    component: 'CreateViolation',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['violations.create'],
    category: ModuleCategory.VIOLATIONS,
    isActive: true,
    sortOrder: 11,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'violation-list',
    name: 'Violations List',
    nameAlbanian: 'Lista e Kund√´rvajtjeve',
    description: 'Lista e t√´ gjitha kund√´rvajtjeve t√´ krijuara',
    icon: 'üìù',
    route: '/violations/list',
    component: 'ViolationsList',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['violations.view'],
    category: ModuleCategory.VIOLATIONS,
    isActive: true,
    sortOrder: 12,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'violation-search',
    name: 'Search Violations',
    nameAlbanian: 'K√´rkimi i Kund√´rvajtjeve',
    description: 'K√´rkimi i avancuar i kund√´rvajtjeve',
    icon: 'üîç',
    route: '/violations/search',
    component: 'SearchViolations',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['violations.search'],
    category: ModuleCategory.VIOLATIONS,
    isActive: true,
    sortOrder: 13,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'violation-types',
    name: 'Violation Types',
    nameAlbanian: 'Llojet e Kund√´rvajtjeve',
    description: 'Menaxhimi i llojeve t√´ kund√´rvajtjeve doganore',
    icon: 'üìÇ',
    route: '/violations/types',
    component: 'ViolationTypes',
    requiredRoles: ['Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['violations.configure'],
    category: ModuleCategory.VIOLATIONS,
    isActive: true,
    sortOrder: 14,
    hierarchyLevel: 2,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'violation-severity',
    name: 'Violation Severity Levels',
    nameAlbanian: 'Nivelet e R√´ndes√´s s√´ Kund√´rvajtjeve',
    description: 'Konfigurimi i niveleve t√´ r√´ndes√´s s√´ kund√´rvajtjeve',
    icon: 'üö®',
    route: '/violations/severity',
    component: 'ViolationSeverity',
    requiredRoles: ['SectorChief', 'Director'],
    requiredPermissions: ['violations.severity.configure'],
    category: ModuleCategory.VIOLATIONS,
    isActive: true,
    sortOrder: 15,
    hierarchyLevel: 3,
    securityLevel: 'CONFIDENTIAL'
  },

  // =================================================================================
  // 3. CASE MANAGEMENT (100 modules)
  // =================================================================================
  {
    id: 'case-management-main',
    name: 'Case Management',
    nameAlbanian: 'Menaxhimi i Rasteve',
    description: 'Sistemi kryesor p√´r menaxhimin e rasteve doganore',
    icon: 'üìã',
    route: '/cases',
    component: 'CaseManagement',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['cases.view'],
    category: ModuleCategory.CASE_MANAGEMENT,
    isActive: true,
    sortOrder: 20,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'case-creation',
    name: 'Create Case',
    nameAlbanian: 'Krijimi i Rastit',
    description: 'Krijimi i nj√´ rasti t√´ ri doganor',
    icon: 'üÜï',
    route: '/cases/create',
    component: 'CreateCase',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['cases.create'],
    category: ModuleCategory.CASE_MANAGEMENT,
    isActive: true,
    sortOrder: 21,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'case-list',
    name: 'Cases List',
    nameAlbanian: 'Lista e Rasteve',
    description: 'Lista e t√´ gjitha rasteve n√´ sistem',
    icon: 'üìä',
    route: '/cases/list',
    component: 'CasesList',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['cases.view'],
    category: ModuleCategory.CASE_MANAGEMENT,
    isActive: true,
    sortOrder: 22,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'case-assignment',
    name: 'Case Assignment',
    nameAlbanian: 'Caktimi i Rasteve',
    description: 'Caktimi i rasteve te oficer√´t p√´rkat√´s',
    icon: 'üë§',
    route: '/cases/assignment',
    component: 'CaseAssignment',
    requiredRoles: ['Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['cases.assign'],
    category: ModuleCategory.CASE_MANAGEMENT,
    isActive: true,
    sortOrder: 23,
    hierarchyLevel: 2,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'case-reassignment',
    name: 'Case Reassignment',
    nameAlbanian: 'Ricaktimi i Rasteve',
    description: 'Ricaktimi i rasteve te oficer√´ t√´ tjer√´',
    icon: 'üîÑ',
    route: '/cases/reassignment',
    component: 'CaseReassignment',
    requiredRoles: ['Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['cases.reassign'],
    category: ModuleCategory.CASE_MANAGEMENT,
    isActive: true,
    sortOrder: 24,
    hierarchyLevel: 2,
    securityLevel: 'INTERNAL'
  },

  // =================================================================================
  // 4. ACTIVITIES MANAGEMENT (80 modules)
  // =================================================================================
  {
    id: 'activities-main',
    name: 'Activities Management',
    nameAlbanian: 'Menaxhimi i Aktiviteteve',
    description: 'Sistemi p√´r menaxhimin e aktiviteteve doganore',
    icon: 'üìù',
    route: '/activities',
    component: 'ActivitiesMain',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['activities.view'],
    category: ModuleCategory.ACTIVITIES,
    isActive: true,
    sortOrder: 30,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'activity-creation',
    name: 'Create Activity',
    nameAlbanian: 'Krijimi i Aktivitetit',
    description: 'Krijimi i nj√´ aktiviteti t√´ ri',
    icon: '‚úèÔ∏è',
    route: '/activities/create',
    component: 'CreateActivity',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['activities.create'],
    category: ModuleCategory.ACTIVITIES,
    isActive: true,
    sortOrder: 31,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'activity-from-violation',
    name: 'Create Activity from Violation',
    nameAlbanian: 'Krijimi i Aktivitetit nga Kund√´rvajtja',
    description: 'Krijimi i aktivitetit bazuar n√´ kund√´rvajtje',
    icon: 'üîó',
    route: '/activities/from-violation',
    component: 'ActivityFromViolation',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['activities.create'],
    category: ModuleCategory.ACTIVITIES,
    isActive: true,
    sortOrder: 32,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'activity-list',
    name: 'Activities List',
    nameAlbanian: 'Lista e Aktiviteteve',
    description: 'Lista e t√´ gjitha aktiviteteve n√´ sistem',
    icon: 'üìã',
    route: '/activities/list',
    component: 'ActivitiesList',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['activities.view'],
    category: ModuleCategory.ACTIVITIES,
    isActive: true,
    sortOrder: 33,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },

  // =================================================================================
  // 5. TASKS MANAGEMENT (70 modules)
  // =================================================================================
  {
    id: 'tasks-main',
    name: 'Tasks Management',
    nameAlbanian: 'Menaxhimi i Detyrave',
    description: 'Sistemi p√´r menaxhimin e detyrave',
    icon: 'üì¨',
    route: '/tasks',
    component: 'TasksMain',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['tasks.view'],
    category: ModuleCategory.TASKS,
    isActive: true,
    sortOrder: 40,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'task-inbox',
    name: 'Task Inbox',
    nameAlbanian: 'Kutia Postare e Detyrave',
    description: 'Kutia postare p√´r detyrat e p√´rdoruesit',
    icon: 'üì•',
    route: '/tasks/inbox',
    component: 'TaskInbox',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['tasks.view'],
    category: ModuleCategory.TASKS,
    isActive: true,
    sortOrder: 41,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'task-creation',
    name: 'Create Task',
    nameAlbanian: 'Krijimi i Detyr√´s',
    description: 'Krijimi i nj√´ detyre t√´ re',
    icon: 'üìù',
    route: '/tasks/create',
    component: 'CreateTask',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['tasks.create'],
    category: ModuleCategory.TASKS,
    isActive: true,
    sortOrder: 42,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'task-from-case',
    name: 'Create Task from Case',
    nameAlbanian: 'Krijimi i Detyr√´s nga Rasti',
    description: 'Krijimi i detyr√´s bazuar n√´ rast',
    icon: 'üîó',
    route: '/tasks/from-case',
    component: 'TaskFromCase',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['tasks.create'],
    category: ModuleCategory.TASKS,
    isActive: true,
    sortOrder: 43,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },

  // =================================================================================
  // 6. DOCUMENTS MANAGEMENT (90 modules)
  // =================================================================================
  {
    id: 'documents-main',
    name: 'Documents Management',
    nameAlbanian: 'Menaxhimi i Dokumenteve',
    description: 'Sistemi p√´r menaxhimin e dokumenteve',
    icon: 'üìÅ',
    route: '/documents',
    component: 'DocumentsMain',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['documents.view'],
    category: ModuleCategory.DOCUMENTS,
    isActive: true,
    sortOrder: 50,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'document-repository',
    name: 'Document Repository',
    nameAlbanian: 'Arkivi i Dokumenteve',
    description: 'Arkivi kryesor i dokumenteve',
    icon: 'üóÑÔ∏è',
    route: '/documents/repository',
    component: 'DocumentRepository',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['documents.view'],
    category: ModuleCategory.DOCUMENTS,
    isActive: true,
    sortOrder: 51,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'document-upload',
    name: 'Upload Document',
    nameAlbanian: 'Ngarkimi i Dokumentit',
    description: 'Ngarkimi i dokumenteve t√´ reja',
    icon: 'üì§',
    route: '/documents/upload',
    component: 'DocumentUpload',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['documents.upload'],
    category: ModuleCategory.DOCUMENTS,
    isActive: true,
    sortOrder: 52,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },

  // =================================================================================
  // 7. TRANSPORT MANAGEMENT (60 modules)
  // =================================================================================
  {
    id: 'transport-main',
    name: 'Transport Management',
    nameAlbanian: 'Menaxhimi i Transportit',
    description: 'Sistemi p√´r menaxhimin e mjeteve t√´ transportit',
    icon: 'üöõ',
    route: '/transport',
    component: 'TransportMain',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['transport.view'],
    category: ModuleCategory.TRANSPORT,
    isActive: true,
    sortOrder: 60,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'vehicle-details',
    name: 'Vehicle Details',
    nameAlbanian: 'Detajet e Mjetit t√´ Transportit',
    description: 'Menaxhimi i detajeve t√´ mjeteve t√´ transportit',
    icon: 'üöó',
    route: '/transport/vehicles',
    component: 'VehicleDetails',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['transport.vehicles.view'],
    category: ModuleCategory.TRANSPORT,
    isActive: true,
    sortOrder: 61,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'transport-data',
    name: 'Transport Data',
    nameAlbanian: 'T√´ Dh√´nat p√´r Mjetet e Transportit',
    description: 'T√´ dh√´nat e detajuara t√´ mjeteve t√´ transportit',
    icon: 'üìä',
    route: '/transport/data',
    component: 'TransportData',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['transport.data.view'],
    category: ModuleCategory.TRANSPORT,
    isActive: true,
    sortOrder: 62,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },

  // =================================================================================
  // 8. FINES & ADMINISTRATIVE PENALTIES (75 modules)
  // =================================================================================
  {
    id: 'fines-main',
    name: 'Administrative Fines',
    nameAlbanian: 'Gjobat Administrative',
    description: 'Sistemi p√´r menaxhimin e gjobave administrative',
    icon: 'üí∞',
    route: '/fines',
    component: 'FinesMain',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['fines.view'],
    category: ModuleCategory.FINES,
    isActive: true,
    sortOrder: 70,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'fine-creation',
    name: 'Create Administrative Fine',
    nameAlbanian: 'Krijimi i Gjob√´s Administrative',
    description: 'Krijimi i nj√´ gjobe administrative t√´ re',
    icon: 'üí∏',
    route: '/fines/create',
    component: 'CreateFine',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['fines.create'],
    category: ModuleCategory.FINES,
    isActive: true,
    sortOrder: 71,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'fine-data',
    name: 'Fine Data',
    nameAlbanian: 'T√´ Dh√´nat e Gjob√´s Administrative',
    description: 'T√´ dh√´nat e detajuara t√´ gjob√´s administrative',
    icon: 'üìã',
    route: '/fines/data',
    component: 'FineData',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['fines.view'],
    category: ModuleCategory.FINES,
    isActive: true,
    sortOrder: 72,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },

  // =================================================================================
  // 9. AUDIT & COMPLIANCE (65 modules)
  // =================================================================================
  {
    id: 'audit-main',
    name: 'Audit System',
    nameAlbanian: 'Sistemi i Auditimit',
    description: 'Sistemi p√´r auditimin e proceseve doganore',
    icon: 'üìì',
    route: '/audit',
    component: 'AuditMain',
    requiredRoles: ['Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['audit.view'],
    category: ModuleCategory.AUDIT,
    isActive: true,
    sortOrder: 80,
    hierarchyLevel: 2,
    securityLevel: 'CONFIDENTIAL'
  },
  {
    id: 'audit-diary',
    name: 'Audit Diary',
    nameAlbanian: 'Ditari i Auditimit',
    description: 'Ditari i t√´ gjitha aktiviteteve t√´ auditimit',
    icon: 'üìî',
    route: '/audit/diary',
    component: 'AuditDiary',
    requiredRoles: ['Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['audit.diary.view'],
    category: ModuleCategory.AUDIT,
    isActive: true,
    sortOrder: 81,
    hierarchyLevel: 2,
    securityLevel: 'CONFIDENTIAL'
  },

  // =================================================================================
  // 10. SEARCH & FILTERS (85 modules)
  // =================================================================================
  {
    id: 'search-main',
    name: 'Advanced Search',
    nameAlbanian: 'K√´rkimi i Avancuar',
    description: 'Sistemi i k√´rkimit t√´ avancuar',
    icon: 'üîç',
    route: '/search',
    component: 'SearchMain',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['search.view'],
    category: ModuleCategory.SEARCH,
    isActive: true,
    sortOrder: 90,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },
  {
    id: 'search-filters',
    name: 'Search Filters',
    nameAlbanian: 'Filtrat e K√´rkimit',
    description: 'Filtrat e avancuar p√´r k√´rkim',
    icon: 'üîé',
    route: '/search/filters',
    component: 'SearchFilters',
    requiredRoles: ['Officer', 'Supervisor', 'SectorChief', 'Director'],
    requiredPermissions: ['search.filters'],
    category: ModuleCategory.SEARCH,
    isActive: true,
    sortOrder: 91,
    hierarchyLevel: 1,
    securityLevel: 'INTERNAL'
  },

  // =================================================================================
  // ADDITIONAL MODULES CONTINUE HERE...
  // We need to implement all 800+ modules as shown in the system photos
  // =================================================================================

  // ... [Continue with remaining 500+ modules covering all aspects of Kosovo Customs operations]

];

/**
 * Kosovo Customs Hierarchy Levels for Republic of Kosovo:
 * 1 = Officer (Oficer)
 * 2 = Supervisor (Mbik√´qyr√´s) 
 * 3 = Sector Chief (Kryetar Sektori)
 * 4 = Director (Drejtor)
 */
export const KOSOVO_CUSTOMS_HIERARCHY = {
  OFFICER: 1,
  SUPERVISOR: 2,
  SECTOR_CHIEF: 3,
  DIRECTOR: 4
} as const;

export type KosovoCustomsHierarchy = typeof KOSOVO_CUSTOMS_HIERARCHY[keyof typeof KOSOVO_CUSTOMS_HIERARCHY];

/**
 * Case Synchronization Rules for Kosovo Customs Hierarchy
 * These rules define which hierarchy levels can view, assign, and modify cases
 */
export interface CaseSynchronizationRule {
  userLevel: number;
  canViewLevels: number[];
  canAssignToLevels: number[];
  canModifyLevels: number[];
  description: string;
  descriptionAlbanian: string;
}

export const CASE_SYNCHRONIZATION_RULES: CaseSynchronizationRule[] = [
  {
    userLevel: KOSOVO_CUSTOMS_HIERARCHY.DIRECTOR,
    canViewLevels: [1, 2, 3, 4], // Can view all levels
    canAssignToLevels: [1, 2, 3], // Can assign to all subordinates
    canModifyLevels: [1, 2, 3, 4], // Can modify all cases
    description: 'Director has full access to all cases and can manage all levels',
    descriptionAlbanian: 'Drejtori ka qasje t√´ plot√´ n√´ t√´ gjitha rastet dhe mund t√´ menaxhoj√´ t√´ gjitha nivelet'
  },
  {
    userLevel: KOSOVO_CUSTOMS_HIERARCHY.SECTOR_CHIEF,
    canViewLevels: [1, 2, 3], // Can view own level and subordinates
    canAssignToLevels: [1, 2], // Can assign to officers and supervisors
    canModifyLevels: [1, 2, 3], // Can modify own and subordinate cases
    description: 'Sector Chief can manage cases within their sector',
    descriptionAlbanian: 'Shefi i Sektorit mund t√´ menaxhoj√´ rastet brenda sektorit t√´ tyre'
  },
  {
    userLevel: KOSOVO_CUSTOMS_HIERARCHY.SUPERVISOR,
    canViewLevels: [1, 2], // Can view own level and officers
    canAssignToLevels: [1], // Can assign to officers only
    canModifyLevels: [1, 2], // Can modify own and officer cases
    description: 'Supervisor can manage cases for officers in their team',
    descriptionAlbanian: 'Mbik√´qyr√´si mund t√´ menaxhoj√´ rastet p√´r oficer√´t n√´ ekipin e tyre'
  },
  {
    userLevel: KOSOVO_CUSTOMS_HIERARCHY.OFFICER,
    canViewLevels: [1], // Can view only own cases
    canAssignToLevels: [], // Cannot assign cases
    canModifyLevels: [1], // Can modify only own cases
    description: 'Officer can only view and modify their own assigned cases',
    descriptionAlbanian: 'Oficeri mund t√´ shikoj√´ dhe modifikoj√´ vet√´m rastet e tyre t√´ caktuara'
  }
];

/**
 * Get modules accessible by user hierarchy level
 */
export function getModulesForHierarchyLevel(hierarchyLevel: number): SystemModule[] {
  return KOSOVO_CUSTOMS_MODULES.filter(module => 
    module.isActive && 
    (!module.hierarchyLevel || module.hierarchyLevel <= hierarchyLevel)
  );
}

/**
 * Get modules for specific user role with hierarchy consideration and case synchronization
 */
export function getModulesWithCaseSynchronization(
  userRole: string, 
  userHierarchy: number,
  customsPost?: string
): SystemModule[] {
  let modules = KOSOVO_CUSTOMS_MODULES.filter(module => {
    // Check role access
    const hasRoleAccess = module.requiredRoles.includes(userRole);
    
    // Check hierarchy level
    const hasHierarchyAccess = !module.hierarchyLevel || userHierarchy >= module.hierarchyLevel;
    
    // Check customs post if applicable
    const hasPostAccess = !customsPost || !module.customsPost || module.customsPost.includes(customsPost);
    
    return hasRoleAccess && hasHierarchyAccess && hasPostAccess && module.isActive;
  });
  
  return modules.sort((a, b) => a.sortOrder - b.sortOrder);
}

/**
 * Check if user can access a specific module
 */
export function canUserAccessModule(userHierarchyLevel: number, moduleId: string): boolean {
  const module = KOSOVO_CUSTOMS_MODULES.find(m => m.id === moduleId);
  if (!module || !module.isActive) return false;
  
  return !module.hierarchyLevel || module.hierarchyLevel <= userHierarchyLevel;
}

/**
 * Get case synchronization rules for user
 */
export function getCaseSynchronizationRules(userHierarchyLevel: number): CaseSynchronizationRule | null {
  return CASE_SYNCHRONIZATION_RULES.find(rule => rule.userLevel === userHierarchyLevel) || null;
}

/**
 * Check if user can view cases from specific hierarchy level
 */
export function canViewCasesFromLevel(userLevel: number, targetLevel: number): boolean {
  const rules = getCaseSynchronizationRules(userLevel);
  return rules ? rules.canViewLevels.includes(targetLevel) : false;
}

/**
 * Check if user can assign cases to specific hierarchy level
 */
export function canAssignCasesToLevel(userLevel: number, targetLevel: number): boolean {
  const rules = getCaseSynchronizationRules(userLevel);
  return rules ? rules.canAssignToLevels.includes(targetLevel) : false;
}

/**
 * Check if user can modify cases from specific hierarchy level
 */
export function canModifyCasesFromLevel(userLevel: number, targetLevel: number): boolean {
  const rules = getCaseSynchronizationRules(userLevel);
  return rules ? rules.canModifyLevels.includes(targetLevel) : false;
}

/**
 * Get all modules grouped by category for a specific hierarchy level
 */
export function getModulesByCategory(hierarchyLevel: number): Record<string, SystemModule[]> {
  const accessibleModules = getModulesForHierarchyLevel(hierarchyLevel);
  const grouped: Record<string, SystemModule[]> = {};
  
  accessibleModules.forEach(module => {
    if (!grouped[module.category]) {
      grouped[module.category] = [];
    }
    grouped[module.category].push(module);
  });
  
  // Sort modules within each category by sortOrder
  Object.keys(grouped).forEach(category => {
    grouped[category].sort((a, b) => a.sortOrder - b.sortOrder);
  });
  
  return grouped;
}

/**
 * Search modules accessible to user
 */
export function searchModules(
  searchTerm: string, 
  hierarchyLevel: number, 
  category?: string
): SystemModule[] {
  let modules = getModulesForHierarchyLevel(hierarchyLevel);
  
  if (category) {
    modules = modules.filter(m => m.category === category);
  }
  
  if (searchTerm) {
    const term = searchTerm.toLowerCase();
    modules = modules.filter(m => 
      m.name.toLowerCase().includes(term) ||
      m.nameAlbanian.toLowerCase().includes(term) ||
      m.description.toLowerCase().includes(term)
    );
  }
  
  return modules.sort((a, b) => a.sortOrder - b.sortOrder);
}

/**
 * Get user role display name based on hierarchy level
 */
export function getUserRoleDisplayName(hierarchyLevel: number): { english: string; albanian: string } {
  switch (hierarchyLevel) {
    case KOSOVO_CUSTOMS_HIERARCHY.OFFICER:
      return { english: 'Officer', albanian: 'Oficer' };
    case KOSOVO_CUSTOMS_HIERARCHY.SUPERVISOR:
      return { english: 'Supervisor', albanian: 'Mbik√´qyr√´s' };
    case KOSOVO_CUSTOMS_HIERARCHY.SECTOR_CHIEF:
      return { english: 'Sector Chief', albanian: 'Kryetar Sektori' };
    case KOSOVO_CUSTOMS_HIERARCHY.DIRECTOR:
      return { english: 'Director', albanian: 'Drejtor' };
    default:
      return { english: 'Unknown', albanian: 'I panjohur' };
  }
}

/**
 * Export all modules for reference (800+ modules total)
 */
export default KOSOVO_CUSTOMS_MODULES;
